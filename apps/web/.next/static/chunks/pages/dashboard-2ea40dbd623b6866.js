(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{4937:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return e(5084)}])},5084:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return s}});var i=e(2322),a=e(2784);function s(){let[n,t]=(0,a.useState)(""),[e,s]=(0,a.useState)("");return(0,i.jsxs)("main",{style:{padding:24,fontFamily:"system-ui",maxWidth:720,margin:"0 auto"},children:[(0,i.jsx)("h1",{children:"Drafts-GPT Dashboard"}),(0,i.jsxs)("section",{style:{marginTop:24},children:[(0,i.jsx)("h3",{children:"1) Microsoft 365"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("a",{href:"/api/auth/login",children:"Sign in with Microsoft"})," \xa0|\xa0 ",(0,i.jsx)("a",{href:"/api/auth/logout",children:"Logout"})]})]}),(0,i.jsxs)("section",{style:{marginTop:24},children:[(0,i.jsx)("h3",{children:"2) Subscribe to mailbox webhook"}),(0,i.jsx)("button",{onClick:async()=>{let n=await fetch("/api/graph/subscribe",{method:"POST"});s(JSON.stringify(await n.json(),null,2))},children:"Create / Renew Subscription"})]}),(0,i.jsxs)("section",{style:{marginTop:24},children:[(0,i.jsx)("h3",{children:"3) Manual draft (for testing)"}),(0,i.jsx)("input",{placeholder:"Message ID",value:n,onChange:n=>t(n.target.value),style:{width:"100%",padding:8,marginBottom:8}}),(0,i.jsx)("button",{onClick:async()=>{let t=await fetch("/api/graph/draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:n})});s(JSON.stringify(await t.json(),null,2))},children:"Create Draft Reply"})]}),(0,i.jsx)("pre",{style:{marginTop:24,background:"#111",color:"#0f0",padding:16,borderRadius:8,overflow:"auto"},children:e})]})}}},function(n){n.O(0,[888,774,179],function(){return n(n.s=4937)}),_N_E=n.O()}]);