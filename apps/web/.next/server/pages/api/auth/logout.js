"use strict";(()=>{var e={};e.id=845,e.ids=[845],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6835:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},9239:(e,t,r)=>{r.r(t),r.d(t,{config:()=>f,default:()=>l,routeModule:()=>d});var n={};r.r(n),r.d(n,{default:()=>s});var i=r(9150),o=r(1631),u=r(6835),a=r(4087);function s(e,t){(0,a.Ov)(t),t.redirect("/")}let l=(0,u.l)(n,"default"),f=(0,u.l)(n,"config"),d=new i.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/auth/logout",pathname:"/api/auth/logout",bundlePath:"",filename:""},userland:n})},4087:(e,t,r)=>{r.d(t,{Ov:()=>f,Gg:()=>l,py:()=>d,KY:()=>s});var n=r(6113);let i=require("cookie"),o="dgpt_sess",u=process.env.SESSION_SECRET;if(!u||u.length<32)throw Error("SESSION_SECRET too short");function a(e){return(0,n.createHash)("sha256").update(u+e).digest("hex")}function s(e,t){let r=JSON.stringify(t),n=a(r);e.setHeader("Set-Cookie",(0,i.serialize)(o,Buffer.from(r).toString("base64")+"."+n,{httpOnly:!0,sameSite:"lax",path:"/",secure:!0,maxAge:2592e3}))}function l(e){let t=(0,i.parse)(e.headers.cookie||"")[o];if(!t)return null;let[r,n]=t.split("."),u=Buffer.from(r||"","base64").toString();return a(u)!==n?null:JSON.parse(u)}function f(e){e.setHeader("Set-Cookie",(0,i.serialize)(o,"",{path:"/",maxAge:0}))}function d(){return(0,n.randomBytes)(16).toString("hex")}},1631:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},9150:(e,t,r)=>{e.exports=r(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=9239);module.exports=r})();